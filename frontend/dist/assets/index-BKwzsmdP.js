import{a as y,h as q,aU as e,b8 as g,aV as _}from"./index-D5NEVckz.js";import{A as z,Q as b,ac as r,ad as I,Z as f,aj as L,C as N,ag as M,L as x,ab as Z,X as V,J as $,a6 as J,ak as Q,aa as O,a8 as P}from"./IdurarOs-V_bURJEp.js";import{s as H,D as W,C as X,a as G,b as K,c as ee,R as te,S as se}from"./index-qdgfoLAy.js";import{d as w}from"./index-O3DPbt57.js";import{c as h}from"./actions-BFmS9m6R.js";import{u as v}from"./index-p47hPObF.js";import{S as U}from"./countryList-D0psjz7l.js";import{D as ae}from"./DeleteOutlined-BTgtJ4nO.js";import{P as ne}from"./PlusOutlined-DT2qKStY.js";import{T as re}from"./index-CO9O4eHP.js";import"./helpers-CdUYrsBY.js";import"./index-DAdER1E4.js";import"./ErpApp-Ds58W3Mv.js";import"./fade-tgczP0FV.js";import"./useDate-BXA71YLp.js";import"./currency.es-9OAR_aOO.js";import"./useDebounce-BTD5RFWC.js";import"./index-KrFx5yLV.js";import"./color-DHucoY0N.js";import"./ArrowRightOutlined-CAGXr5Fg.js";import"./Table-BbISnBIN.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};const le=oe;var ie=function(n,s){return y.createElement(z,q({},n,{ref:s,icon:le}))};const de=y.forwardRef(ie);function B({isUpdateForm:t=!1,isForAdminOwner:n=!1}){const s=b();return e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{label:s("first Name"),name:"name",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(r.Item,{label:s("last Name"),name:"surname",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(r.Item,{label:s("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(I,{autoComplete:"off"})}),!t&&e.jsx(r.Item,{label:s("Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(r.Item,{label:s("Role"),name:"role",rules:[{required:!0}],children:e.jsxs(f,{children:[e.jsx(f.Option,{value:"owner",disabled:!n,children:s("Account owner")}),e.jsx(f.Option,{value:"admin",disabled:n,children:s("super_admin")}),e.jsx(f.Option,{value:"manager",disabled:n,children:s("manager")}),e.jsx(f.Option,{value:"employee",disabled:n,children:s("employee")}),e.jsx(f.Option,{value:"create_only",disabled:n,children:s("create_only")}),e.jsx(f.Option,{value:"read_only",disabled:n,children:s("read_only")})]})}),e.jsx(r.Item,{label:s("enabled"),name:"enabled",valuePropName:"checked",initialValue:!0,children:e.jsx(U,{checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(N,{})})})]})}function ce({config:t,formElements:n,withUpload:s=!1}){let{entity:o}=t;const m=b(),d=g(),{current:l,isLoading:u,isSuccess:c}=_(H),{state:i,crudContextAction:p}=v(),{panel:j,collapsedBox:T,readBox:S}=p,k=()=>{S.open()},[E,D]=y.useState(!1),[C]=r.useForm(),F=a=>{const A=l._id;a.file&&s&&(a.file=a.file[0].originFileObj),d(h.update({entity:o,id:A,jsonData:a,withUpload:s}))};y.useEffect(()=>{if(l){let a={...l};a.birthday&&(a={...a,birthday:w(a.birthday).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.date&&(a={...a,date:w(a.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.expiredDate&&(a={...a,expiredDate:w(a.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.created&&(a={...a,created:w(a.created).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.updated&&(a={...a,updated:w(a.updated).format("YYYY-MM-DDTHH:mm:ss.SSSZ")});const A=l.role==="owner";D(A),C.resetFields(),C.setFieldsValue(a)}},[l]),y.useEffect(()=>{c&&(S.open(),T.open(),j.open(),C.resetFields(),d(h.resetAction({actionType:"update"})),d(h.list({entity:o})))},[c]);const{isEditBoxOpen:Y}=i,R=Y?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:R,children:e.jsx(M,{isLoading:u,children:e.jsxs(r,{form:C,layout:"vertical",onFinish:F,children:[e.jsx(B,{isUpdateForm:!0,isForAdminOwner:E}),e.jsx(r.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:m("Save")})}),e.jsx(r.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:k,children:m("Cancel")})})]})})})}function me({config:t}){const n=b();return e.jsx(W,{config:t,extra:[{label:n("Update Password"),key:"updatePassword",icon:e.jsx(de,{})}]})}function ue({config:t}){const n=b(),s=g(),{current:o}=_(H),{state:m,crudContextAction:d}=v(),[l]=r.useForm(),{onFetch:u,result:c,isLoading:i,isSuccess:p}=Z(),j=D=>{const C="admin/password-update/"+o._id,Y=(async()=>await V.patch({entity:C,jsonData:D}))();u(Y)},{readBox:T}=d,S=()=>{T.open()};y.useEffect(()=>{p&&(l.resetFields(),s(h.resetAction({actionType:"update"})))},[p]);const{isAdvancedBoxOpen:k}=m,E=k?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:E,children:e.jsxs(M,{isLoading:i,children:[e.jsx("h3",{children:n("Update Password")}),e.jsx("div",{className:"space10"}),e.jsxs(r,{form:l,layout:"vertical",onFinish:j,children:[e.jsx(r.Item,{label:n("New Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(r.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:n("Save")})}),e.jsx(r.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:S,children:n("Cancel")})})]})]})})}function pe({config:t,formElements:n}){const s=b(),{crudContextAction:o}=v(),{advancedBox:m,modal:d,editBox:l}=o,{result:u}=_(ee),c=g(),i=()=>{c(h.currentAction({actionType:"delete",data:u})),d.open()},p=()=>{c(h.currentAction({actionType:"update",data:u})),l.open()},j=()=>{c(h.currentAction({actionType:"update",data:u})),m.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs($,{children:[e.jsx(x,{onClick:i,type:"text",icon:e.jsx(ae,{}),size:"small",children:s("remove")}),e.jsx(x,{onClick:p,type:"text",icon:e.jsx(J,{}),size:"small",children:s("edit")}),e.jsx(x,{onClick:j,type:"text",icon:e.jsx(Q,{}),size:"small",children:s("Update Password")})]}),e.jsx("div",{className:"space20"}),e.jsx(te,{config:t}),e.jsx(ce,{config:t,formElements:n,withUpload:!0}),e.jsx(ue,{config:t})]})}function xe({config:t}){const{crudContextAction:n}=v(),{collapsedBox:s}=n,o=()=>{s.close()};return e.jsxs(e.Fragment,{children:[e.jsx(O,{gutter:12,children:e.jsx(P,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(O,{gutter:8,children:[e.jsx(P,{className:"gutter-row",span:21,children:e.jsx(se,{config:t})}),e.jsx(P,{className:"gutter-row",span:3,children:e.jsx(x,{onClick:o,block:!0,icon:e.jsx(ne,{})})})]})]})}function he({config:t,createForm:n,updateForm:s}){const o=g();return y.useLayoutEffect(()=>{o(h.resetState())},[]),e.jsxs(X,{config:t,fixHeaderPanel:e.jsx(xe,{config:t}),sidePanelBottomContent:e.jsx(G,{config:t,formElements:n,withUpload:!1}),sidePanelTopContent:e.jsx(pe,{config:t,formElements:s}),children:[e.jsx(me,{config:t}),e.jsx(K,{config:t})]})}const je={owner:"gold",admin:"magenta",manager:"purple",employee:"blue",create_only:"green",read_only:null};function Me(){const t=b(),n="admin",s={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},o=["email"],m=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],d=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role",render:(i,p)=>{const j=i==="owner"?"Account owner":i==="admin"?"super admin":i;return e.jsx(re,{color:je[i],children:t(j)})}},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:(i,p)=>e.jsx(U,{checked:i,checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(N,{})})}],l={PANEL_TITLE:t("admin"),DATATABLE_TITLE:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},c={...{entity:n,...l},readColumns:m,dataTableColumns:d,searchConfig:s,deleteModalLabels:o};return e.jsx(he,{createForm:e.jsx(B,{}),config:c})}export{Me as default};
